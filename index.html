<html>
  <head>
    <title>AR.js Basic Projected Camera Example</title>
    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>
    <!-- Look-at component. We don't need this now, but we will later. -->
    <script src="https://unpkg.com/aframe-look-at-component@0.8.0/dist/aframe-look-at-component.min.js"></script>
    <script type="text/javascript" src="peakfinder.js"></script>
  </head>
  <body style="margin: 0; overflow: hidden">
    <a-scene
      vr-mode-ui="enabled: false"
      arjs="sourceType: webcam; videoTexture: true; debugUIEnabled: false;"
      renderer="antialias: false; alpha: true"
    >
      <!-- <a-sphere gps-projected-entity-place="latitude:  33.063034; longitude:-16.354469" material="color: white" scale="3 3 3"></a-sphere>
      <a-sphere gps-projected-entity-place="latitude:33.06285; longitude:-16.3542" material="color: blue" scale="3 3 3"></a-sphere> -->

      <a-camera gps-projected-camera rotation-reader></a-camera>
      <!-- <a-entity peakfinder></a-entity> -->
    </a-scene>
  </body>
  <footer>Version</footer>
  <script>
    let lat = 33.063034
    let lng = -16.354469

    navigator.geolocation.getCurrentPosition(function success(position) {
      lat = position.coords.latitude
      lng = position.coords.longitude
      let sceneEl = document.querySelector('a-scene')

      let newLat = lat + (-0.002 / 111) * (180 / 3.14159265)
      let newLng = lng + ((-0.002 / 111) * (180 / 3.14159265)) / Math.cos((lat * 3.14159265) / 180)

      let markerEl = document.createElement('a-sphere')
      markerEl.setAttribute('color', 'white')
      markerEl.setAttribute('scale', '3 3 3')
      markerEl.setAttribute('gps-projected-entity-place', `latitude: ${newLat};longitude: ${newLng}`)
      console.log('coords:', `lat: ${lat}; lng:${lng}`)
      console.log('new coords:', `lat: ${newLat}; lng:${newLng}`)
      sceneEl.appendChild(markerEl)
    })
  </script>
</html>
